## 前端非侵入式开发

之前介绍了前端侵入式开发，这种开发方式需要修改服务端代码，有很大的风险，并且需要依赖后端，如果后端服务的项目是已经打包好的项目，比如jar包或tar包，这种方式就无法使用了。

今天向大家介绍一种方法，该方法对于浏览器渲染的页面，统统有效。不论后端服务有无打包。并且十分灵活。

在正式介绍该方法之前，我们首先聊接一下浏览器请求服务的过程。

![](https://ws2.sinaimg.cn/large/006tNc79ly1g1wcqy2nc0j30u00h4jrb.jpg)

浏览器请求服务端时，浏览器解析url然后将url发给DNS,DNS把地址解析为ip地址，发送给服务器。服务器将请求结果发给浏览器。

我们想做非侵入式开发，就在要浏览器向DNS发送数据时做一些自定义的事情，如图

![](https://ws1.sinaimg.cn/large/006tNc79ly1g1wd64miajj30og0sqq3q.jpg)


我们在浏览器发起请求钱做一次地址拦截，将指定url转发到本地的一个服务上，在这一层上我们匹配地址时粒度可以大一些，更小粒度的匹配将在服务端去做。在服务端我们队请求的内容进行判断，如果请求的是本地文件，那我们就将本地文件读取后发送给服务器；如果请求的是接口，就直接将请求转发出去。

进过上面的讲述我们发现，有两个事情需要我们去做，一、拦截地址，二、转发请求。

地址拦截方面，可以从系统层面进行拦截，也可以从浏览器层面进行拦截，由于转发请求这件事大部分情况只是在开发过程中使用，生活中使用较少。为兼顾工作和生活，我这里选择在浏览器层面进行拦截。这里介绍一个常用的chrome插件：SwitchyOmega,他支持网址通配符，域名通配符和网络正则。配置简单。功能强大。

安装方法：进入chrome商店收缩 SwitchyOmega ，点击安装便可。

安装成功后，在浏览器工具栏点击SwitchyOmega的图标，选择选项按钮。进入配置页面。在情景模式下，点击新建情景模式。选择代理服务器。输入协议、服务器地址及端口。
按照上述方法，新建一个自动切换的情景模式。选择条件类型，在条件设置列输入指定的地址。然后选择情景模式。
这样下次浏览器发起请求时，SwitchyOmega 就会把指定的地址转发到指定的服务上。

我们知道，浏览器因安全考虑，禁止读取本地文件，所以转发请求这件事还需要在本地启动一个服务来帮我们完成，这里介绍一个做地址转发的服务whistle，该服务使用node编写，安装也非常简单，
```
  npm install whistle -g
```

使用更加简单

```
w2 start 
```

这样whistle 会启动一个默认端口为8899的服务，使用浏览器输入localhost:8899，便会进入配置页面。

依据上面SwitchyOmega设定的地址，我们可以更小粒度的设置转发地址。

这样前端非侵入开发的环境便搭建完毕了。该环境不但能请求服务接口，也可请求本地文件。极大的方便了前端的开发。在我平时的开发中，给我很大的帮助。